# ğŸ“¦ ç‰ˆæœ¬æ›´æ–°ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## ğŸ¯ ç‰ˆæœ¬å·è§„åˆ™

### æ ¼å¼
```
V + å¹´æœˆæ—¥ï¼ˆ6ä½ï¼‰ + . + æ€»æ›´æ–°æ¬¡æ•°
```

### ç¤ºä¾‹
- `V251219.1` - 2025å¹´12æœˆ19æ—¥ï¼Œæ€»ç¬¬1æ¬¡æ›´æ–°
- `V251219.2` - 2025å¹´12æœˆ19æ—¥ï¼Œæ€»ç¬¬2æ¬¡æ›´æ–°
- `V251220.3` - 2025å¹´12æœˆ20æ—¥ï¼Œæ€»ç¬¬3æ¬¡æ›´æ–°ï¼ˆè·¨å¤©ï¼Œæ€»æ¬¡æ•°ç»§ç»­é€’å¢ï¼‰

### è§„åˆ™è¯´æ˜
- âœ… **æ€»æ›´æ–°æ¬¡æ•°æ˜¯ç´¯è®¡çš„**ï¼Œä¸ä¼šå› ä¸ºè·¨å¤©è€Œé‡ç½®
- âœ… æ¯æ¬¡æ›´æ–°ç‰ˆæœ¬å·æ—¶ï¼Œæ€»æ›´æ–°æ¬¡æ•° = å†å²æ‰€æœ‰ç‰ˆæœ¬æ€»æ•° + 1
- âœ… ç‰ˆæœ¬å·ä¼šè‡ªåŠ¨æ›´æ–°åˆ°3ä¸ªæ–‡ä»¶ï¼š`index.html`ã€`public/sw.js`ã€`public/manifest.json`

---

## ğŸš€ å¦‚ä½•å‘å¸ƒæ–°ç‰ˆæœ¬

### æ–¹æ³•ä¸€ï¼šè‡ªåŠ¨æ›´æ–°ï¼ˆæ¨èï¼‰â­

```bash
# 1. æ›´æ–°ç‰ˆæœ¬å·ï¼ˆå¸¦æ›´æ–°è¯´æ˜ï¼‰
npm run update-version "ä¿®å¤äº†bugï¼Œä¼˜åŒ–äº†æ€§èƒ½"

# 2. æ„å»ºé¡¹ç›®
npm run build

# 3. æäº¤å¹¶æ¨é€
git add .
git commit -m "chore: æ›´æ–°ç‰ˆæœ¬åˆ° V251219.2"
git push
```

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨æ›´æ–°

```bash
# 1. æ‰‹åŠ¨è¿è¡Œè„šæœ¬
node update-version.js "æ–°å¢äº†xxxåŠŸèƒ½"

# 2. æ„å»ºé¡¹ç›®
npm run build

# 3. æäº¤å¹¶æ¨é€
git add .
git commit -m "chore: æ›´æ–°ç‰ˆæœ¬åˆ° V251219.2"
git push
```

---

## ğŸ“ æ›´æ–°è¯´æ˜ç¤ºä¾‹

### æ–°å¢åŠŸèƒ½
```bash
npm run update-version "âœ¨ æ–°å¢è¯å“å®šæ—¶æé†’åŠŸèƒ½"
```

### ä¿®å¤Bug
```bash
npm run update-version "ğŸ› ä¿®å¤iOSè®¾å¤‡ç…§ç‰‡ä¸Šä¼ é—®é¢˜"
```

### æ€§èƒ½ä¼˜åŒ–
```bash
npm run update-version "âš¡ ä¼˜åŒ–æ•°æ®åŒæ­¥é€Ÿåº¦ï¼Œå‡å°‘ç½‘ç»œè¯·æ±‚"
```

### å¤šæ¡æ›´æ–°
```bash
npm run update-version "âœ¨ æ–°å¢åŠŸèƒ½\nğŸ› ä¿®å¤bug\nâš¡ æ€§èƒ½ä¼˜åŒ–"
```

---

## ğŸ” ç‰ˆæœ¬æ›´æ–°ç³»ç»Ÿå·¥ä½œåŸç†

### 1. æ–‡ä»¶ç»“æ„

```
meds/
â”œâ”€â”€ update-version.js          # ç‰ˆæœ¬æ›´æ–°è„šæœ¬
â”œâ”€â”€ update-log.json            # æ›´æ–°æ—¥å¿—ï¼ˆJSONæ ¼å¼ï¼‰
â”œâ”€â”€ index.html                 # åŒ…å« APP_VERSION å¸¸é‡å’Œ SW æ³¨å†Œ
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ sw.js                  # Service Workerï¼ˆåŒ…å«ç‰ˆæœ¬å·ï¼‰
â”‚   â””â”€â”€ manifest.json          # PWAæ¸…å•ï¼ˆåŒ…å«ç‰ˆæœ¬å·ï¼‰
â””â”€â”€ src/
    â””â”€â”€ components/
        â””â”€â”€ UpdateNotification.tsx  # æ›´æ–°æç¤ºç»„ä»¶
```

### 2. ç‰ˆæœ¬æ£€æµ‹æµç¨‹

```
ç”¨æˆ·æ‰“å¼€åº”ç”¨
    â†“
Service Worker æ³¨å†Œ
    â†“
å®šæœŸæ£€æŸ¥æ›´æ–°ï¼ˆæ¯åˆ†é’Ÿï¼‰
    â†“
å‘ç°æ–°ç‰ˆæœ¬
    â†“
è§¦å‘ 'sw-update-available' äº‹ä»¶
    â†“
UpdateNotification ç»„ä»¶æ˜¾ç¤ºå¼¹çª—
    â†“
ç”¨æˆ·ç‚¹å‡»"ç«‹å³æ›´æ–°"
    â†“
æ¸…é™¤ç¼“å­˜ â†’ åˆ·æ–°é¡µé¢ â†’ åŠ è½½æ–°ç‰ˆæœ¬
```

### 3. æ›´æ–°æ—¥å¿—æ ¼å¼

`update-log.json` æ ¼å¼ï¼š

```json
{
  "V251219.1": {
    "title": "ç‰ˆæœ¬æ›´æ–° V251219.1",
    "date": "2025-12-19T00:00:00.000Z",
    "content": [
      "âœ¨ æ–°å¢ç‰ˆæœ¬æ›´æ–°æ£€æµ‹ç³»ç»Ÿ",
      "ğŸ”„ å®Œå–„å¤šè®¾å¤‡å³æ—¶åŒæ­¥æœºåˆ¶",
      "ğŸ“± æ”¯æŒmedicationsè¡¨å®æ—¶ç›‘å¬"
    ]
  },
  "V251219.2": {
    "title": "ç‰ˆæœ¬æ›´æ–° V251219.2",
    "date": "2025-12-19T12:30:00.000Z",
    "content": [
      "ğŸ› ä¿®å¤iOSè®¾å¤‡å…¼å®¹æ€§é—®é¢˜",
      "âš¡ ä¼˜åŒ–é¦–å±åŠ è½½é€Ÿåº¦"
    ]
  }
}
```

---

## ğŸ¨ æ›´æ–°å¼¹çª—ç•Œé¢

### å¤–è§‚
- ğŸ¯ **ä½ç½®**: å±å¹•ä¸­å¤®ï¼Œæ¨¡æ€å¼¹çª—
- ğŸŒˆ **æ ·å¼**: æ¸å˜å¤´éƒ¨ï¼ˆè“ç´«è‰²ï¼‰ï¼Œç™½è‰²å†…å®¹åŒº
- âœ¨ **åŠ¨ç”»**: æ·¡å…¥+ç¼©æ”¾æ•ˆæœ
- ğŸ“± **å“åº”å¼**: å®Œç¾é€‚é…æ‰‹æœºå’Œæ¡Œé¢ç«¯

### åŠŸèƒ½
- âœ… æ˜¾ç¤ºç‰ˆæœ¬å·å’Œæ›´æ–°å†…å®¹
- âœ… æ”¯æŒ"ç«‹å³æ›´æ–°"æˆ–"ç¨åæ›´æ–°"
- âœ… ç‚¹å‡»æ›´æ–°è‡ªåŠ¨æ¸…é™¤ç¼“å­˜å¹¶åˆ·æ–°
- âœ… å·²è¯»çŠ¶æ€è®°å½•ï¼ˆé¿å…é‡å¤æ˜¾ç¤ºï¼‰

### ç¤ºä¾‹æˆªå›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”„  ç‰ˆæœ¬æ›´æ–° V251219.2        â”‚
â”‚      å‘ç°æ–°ç‰ˆæœ¬å¯ç”¨            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ âœ¨ æ–°å¢è¯å“å®šæ—¶æé†’åŠŸèƒ½    â”‚
â”‚ â€¢ ğŸ› ä¿®å¤iOSè®¾å¤‡ç…§ç‰‡ä¸Šä¼ é—®é¢˜  â”‚
â”‚ â€¢ âš¡ ä¼˜åŒ–æ•°æ®åŒæ­¥é€Ÿåº¦          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ç¨åæ›´æ–°]    [ğŸ”„ ç«‹å³æ›´æ–°]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› ï¸ å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•ä¿®æ”¹ç‰ˆæœ¬å·æ ¼å¼ï¼Ÿ

**A**: ç¼–è¾‘ `update-version.js` ä¸­çš„ `getNewVersion()` å‡½æ•°ã€‚

### Q2: ç”¨æˆ·ä¸æ›´æ–°æ€ä¹ˆåŠï¼Ÿ

**A**: ç”¨æˆ·é€‰æ‹©"ç¨åæ›´æ–°"åï¼Œä¸‹æ¬¡æ‰“å¼€åº”ç”¨ä¼šå†æ¬¡æç¤ºï¼ˆå¦‚æœç‰ˆæœ¬å·ä»ç„¶ä¸åŒï¼‰ã€‚

### Q3: å¦‚ä½•å¼ºåˆ¶ç”¨æˆ·æ›´æ–°ï¼Ÿ

**A**: å¯ä»¥ä¿®æ”¹ `UpdateNotification.tsx`ï¼Œç§»é™¤"ç¨åæ›´æ–°"æŒ‰é’®ï¼Œåªä¿ç•™"ç«‹å³æ›´æ–°"ã€‚

### Q4: æ›´æ–°æ—¥å¿—æ”¯æŒå¤šè¯­è¨€å—ï¼Ÿ

**A**: ç›®å‰åªæ”¯æŒä¸­æ–‡ã€‚å¦‚éœ€å¤šè¯­è¨€ï¼Œéœ€ä¿®æ”¹ `update-log.json` æ ¼å¼å¹¶è°ƒæ•´ç»„ä»¶é€»è¾‘ã€‚

### Q5: å¦‚ä½•æŸ¥çœ‹å½“å‰ç‰ˆæœ¬å·ï¼Ÿ

**A**: 
- æµè§ˆå™¨æ§åˆ¶å°è¾“å…¥ï¼š`APP_VERSION`
- æˆ–æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°æ—¥å¿—ï¼š`ğŸ“¦ å½“å‰ç‰ˆæœ¬: V251219.1`

### Q6: Service Worker ä¸æ›´æ–°æ€ä¹ˆåŠï¼Ÿ

**A**: 
```javascript
// æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œ
await caches.keys().then(keys => Promise.all(keys.map(k => caches.delete(k))))
location.reload()
```

---

## ğŸ“Š ç‰ˆæœ¬æ›´æ–°ç»Ÿè®¡

### æŸ¥çœ‹ç‰ˆæœ¬å†å²

```bash
# æŸ¥çœ‹æ‰€æœ‰ç‰ˆæœ¬
cat update-log.json | jq 'keys'

# æŸ¥çœ‹ç‰ˆæœ¬æ•°é‡
cat update-log.json | jq 'keys | length'

# æŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬
cat update-log.json | jq 'keys | sort | last'
```

### ç‰ˆæœ¬å¯¹æ¯”

```bash
# æ¯”è¾ƒä¸¤ä¸ªç‰ˆæœ¬çš„å·®å¼‚
git diff V251219.1 V251219.2
```

---

## ğŸ” å®‰å…¨æ³¨æ„äº‹é¡¹

### 1. ç‰ˆæœ¬å·é˜²ç¯¡æ”¹

Service Worker ä¸­çš„ç‰ˆæœ¬å·åº”ä¸ `index.html` ä¸­çš„ `APP_VERSION` ä¸€è‡´ã€‚å¦‚æœä¸ä¸€è‡´ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è§¦å‘æ›´æ–°æç¤ºã€‚

### 2. ç¼“å­˜ç­–ç•¥

- **å…³é”®èµ„æº**ï¼ˆHTMLã€CSSã€JSï¼‰ï¼šç½‘ç»œä¼˜å…ˆï¼Œå¤±è´¥æ—¶ä½¿ç”¨ç¼“å­˜
- **å…¶ä»–èµ„æº**ï¼ˆå›¾ç‰‡ã€å­—ä½“ï¼‰ï¼šç¼“å­˜ä¼˜å…ˆ

### 3. æ›´æ–°æ—¥å¿—ä¿æŠ¤

`update-log.json` ä¸åº”åŒ…å«æ•æ„Ÿä¿¡æ¯æˆ–æœºå¯†æ•°æ®ã€‚

---

## ğŸ“ˆ æœ€ä½³å®è·µ

### 1. ç‰ˆæœ¬å‘å¸ƒé¢‘ç‡

- ğŸ”¸ **å°æ›´æ–°**ï¼ˆbugä¿®å¤ï¼‰ï¼šéšæ—¶å‘å¸ƒ
- ğŸ”¸ **ä¸­æ›´æ–°**ï¼ˆåŠŸèƒ½ä¼˜åŒ–ï¼‰ï¼šæ¯å‘¨1-2æ¬¡
- ğŸ”¸ **å¤§æ›´æ–°**ï¼ˆæ–°åŠŸèƒ½ï¼‰ï¼šæ¯æœˆ1æ¬¡

### 2. æ›´æ–°è¯´æ˜æ’°å†™

- âœ… ä½¿ç”¨emojiå¢å¼ºå¯è¯»æ€§
- âœ… ç®€æ´æ˜äº†ï¼Œæ¯æ¡ä¸è¶…è¿‡20å­—
- âœ… æŒ‰é‡è¦æ€§æ’åºï¼ˆæ–°åŠŸèƒ½ > ä¿®å¤ > ä¼˜åŒ–ï¼‰
- âœ… ä½¿ç”¨ç”¨æˆ·èƒ½ç†è§£çš„è¯­è¨€

### 3. æµ‹è¯•æµç¨‹

```bash
# 1. æ›´æ–°ç‰ˆæœ¬
npm run update-version "æµ‹è¯•æ›´æ–°"

# 2. æœ¬åœ°æµ‹è¯•
npm run dev

# 3. æ„å»ºæµ‹è¯•
npm run build
npm run preview

# 4. ç¡®è®¤æ— è¯¯åæ¨é€
git push
```

---

## ğŸ¯ ç¤ºä¾‹å·¥ä½œæµ

### åœºæ™¯ï¼šä¿®å¤äº†ä¸€ä¸ªbug

```bash
# 1. ä¿®æ”¹ä»£ç 
# ... ä¿®å¤ bug ...

# 2. æ›´æ–°ç‰ˆæœ¬
npm run update-version "ğŸ› ä¿®å¤iOSè®¾å¤‡ç…§ç‰‡é€‰æ‹©é—®é¢˜"

# 3. æ„å»º
npm run build

# 4. æµ‹è¯•
npm run preview
# æµè§ˆå™¨æ‰“å¼€ http://localhost:4173 æµ‹è¯•

# 5. æäº¤
git add .
git commit -m "fix: ä¿®å¤iOSè®¾å¤‡ç…§ç‰‡é€‰æ‹©é—®é¢˜"
git push

# 6. ç”¨æˆ·ç«¯
# ç”¨æˆ·æ‰“å¼€åº”ç”¨åï¼Œä¼šåœ¨1åˆ†é’Ÿå†…æ”¶åˆ°æ›´æ–°æç¤º
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- æµè§ˆå™¨æ§åˆ¶å°æ—¥å¿—
- Service Worker çŠ¶æ€ï¼š`chrome://serviceworker-internals/`
- ç¼“å­˜çŠ¶æ€ï¼š`chrome://cache/`

---

**ç‰ˆæœ¬**: V251219.1  
**ä½œè€…**: sevenoy  
**æœ€åæ›´æ–°**: 2025å¹´12æœˆ19æ—¥
