# 本地测试指南

## ✅ 服务器状态

开发服务器已启动，访问地址：**http://localhost:3000**

## 🧪 测试步骤

### 1. 基础功能测试

#### 1.1 页面加载
- [ ] 打开 http://localhost:3000
- [ ] 检查页面是否正常加载
- [ ] 检查是否有默认的3个药物显示

#### 1.2 相机拍照功能
- [ ] 点击任意药物卡片上的相机按钮
- [ ] 检查相机模态框是否弹出
- [ ] 选择一张照片（建议使用有 EXIF 信息的照片）
- [ ] 检查预览是否正常显示
- [ ] 点击"确认上传"
- [ ] 检查是否成功记录

#### 1.3 时间线查看
- [ ] 切换到 "History" 标签页
- [ ] 检查已服用的药物是否显示在时间线中
- [ ] 检查时间信息是否正确显示
- [ ] 检查照片是否正常显示

### 2. EXIF 时间提取测试

#### 2.1 有 EXIF 的照片
- [ ] 使用手机拍摄一张新照片
- [ ] 上传该照片
- [ ] 检查"Taken At (EXIF)"时间是否正确
- [ ] 检查时间来源是否显示为 "EXIF"

#### 2.2 无 EXIF 的照片（截图）
- [ ] 上传一张截图或转发图片
- [ ] 检查系统是否降级到系统时间
- [ ] 检查时间来源是否显示为 "System"

#### 2.3 时间可信度
- [ ] 上传一张刚刚拍摄的照片（应该显示 "ontime"）
- [ ] 上传一张1小时前拍摄的照片（应该显示 "late"）
- [ ] 上传一张6小时前拍摄的照片（应该显示 "suspect"）

### 3. 本地数据库测试

#### 3.1 数据持久化
- [ ] 记录一次服药
- [ ] 刷新页面
- [ ] 检查数据是否仍然存在

#### 3.2 离线功能
- [ ] 断开网络连接
- [ ] 尝试记录服药
- [ ] 检查是否仍然可以正常工作（Mock 模式）

### 4. 多设备同步测试（需要 Supabase）

如果配置了 Supabase：

#### 4.1 同步提示
- [ ] 在另一个设备/浏览器中添加记录
- [ ] 检查当前设备是否显示同步提示
- [ ] 点击"加载最新"接受同步
- [ ] 检查数据是否正确同步

#### 4.2 冲突检测
- [ ] 在同一记录上同时修改
- [ ] 检查是否显示冲突提示

## 🔍 浏览器控制台检查

打开浏览器开发者工具（F12），检查：

- [ ] 是否有 JavaScript 错误
- [ ] 是否有网络请求失败
- [ ] 检查 IndexedDB 中的数据（Application > Storage > IndexedDB）

## 🐛 常见问题

### 问题1：照片上传失败
- **原因**：可能是文件格式不支持
- **解决**：确保使用图片格式（jpg, png, webp）

### 问题2：EXIF 时间提取失败
- **原因**：照片没有 EXIF 信息（截图、转发图片）
- **解决**：这是正常行为，系统会降级到系统时间

### 问题3：页面空白
- **原因**：可能是编译错误
- **解决**：检查浏览器控制台的错误信息

### 问题4：数据丢失
- **原因**：IndexedDB 被清除
- **解决**：这是正常行为，刷新页面会重新初始化默认数据

## 📊 测试检查清单

- [ ] 页面正常加载
- [ ] 相机功能正常
- [ ] 照片上传成功
- [ ] EXIF 时间提取正确
- [ ] 时间可信度计算正确
- [ ] 数据持久化正常
- [ ] 时间线显示正确
- [ ] 进度环计算正确
- [ ] 离线功能正常（Mock 模式）
- [ ] 无控制台错误

## 🎯 下一步

测试完成后，可以：

1. 配置 Supabase 进行多设备同步测试
2. 添加更多药物进行测试
3. 测试边界情况（大量数据、网络异常等）



