# 如何更新到最新版本

## 🔄 方法1：使用强制更新工具（推荐）

### 步骤：

1. **访问更新页面**
   ```
   https://sevenoy.github.io/meds/force-update.html
   ```

2. **点击"强制更新"按钮**
   - 工具会自动清除所有缓存
   - 注销所有 Service Worker
   - 3秒后自动跳转到最新版本

3. **完成！**
   - 应用会自动打开最新版本 V251219.8

---

## 🖥️ 方法2：手动清除浏览器缓存

### Chrome / Edge浏览器：

1. **打开开发者工具**
   - Windows: `F12` 或 `Ctrl + Shift + I`
   - Mac: `Cmd + Option + I`

2. **右键点击刷新按钮**
   - 长按刷新按钮（左上角）
   - 选择 **"清空缓存并硬性重新加载"**

3. **或者使用快捷键**
   - Windows: `Ctrl + Shift + R` 或 `Ctrl + F5`
   - Mac: `Cmd + Shift + R`

### Safari浏览器（Mac）：

1. **清除缓存**
   - 打开 Safari → 偏好设置 → 高级
   - 勾选"在菜单栏中显示开发菜单"
   - 菜单栏 → 开发 → 清空缓存
   - 或使用快捷键：`Cmd + Option + E`

2. **硬刷新**
   - `Cmd + Shift + R`

### Firefox浏览器：

1. **打开开发者工具**
   - Windows: `F12` 或 `Ctrl + Shift + I`
   - Mac: `Cmd + Option + I`

2. **右键点击刷新按钮**
   - 选择 **"强制刷新"**

3. **或者使用快捷键**
   - Windows: `Ctrl + Shift + R` 或 `Ctrl + F5`
   - Mac: `Cmd + Shift + R`

---

## 📱 方法3：手机浏览器更新

### iOS Safari：

1. **清除网站数据**
   - 设置 → Safari → 高级 → 网站数据
   - 搜索 "github.io"
   - 左滑删除相关网站

2. **重新访问应用**
   - 打开 Safari
   - 访问：`https://sevenoy.github.io/meds/`

### Android Chrome：

1. **清除网站数据**
   - 设置 → 隐私和安全 → 清除浏览数据
   - 选择 "缓存的图片和文件"
   - 点击 "清除数据"

2. **或者在应用内清除**
   - 打开应用网址
   - 右上角三个点 → 设置 → 隐私权 → 清除浏览数据
   - 选择 "缓存的图片和文件"
   - 确定

3. **重新访问应用**

---

## 🔍 方法4：检查是否已更新成功

### 在浏览器中检查：

1. **打开浏览器控制台**
   - Windows: `F12`
   - Mac: `Cmd + Option + I`

2. **查看Console标签**
   - 寻找这行日志：
   ```
   📦 当前版本: V251219.8
   ```

3. **如果看到这个版本号，说明更新成功！**

### 在应用中检查：

1. **打开应用**
2. **查看底部或设置页面**
   - 应该显示：`版本 V251219.8`

---

## ⚠️ 常见问题

### Q1: 为什么我的浏览器没有自动更新？

**A**: 这是PWA应用的特性，浏览器会缓存旧版本以支持离线使用。需要手动清除缓存才能看到新版本。

### Q2: 我清除了缓存，但还是看到旧版本？

**A**: 请尝试以下步骤：

1. 完全关闭浏览器（所有窗口）
2. 重新打开浏览器
3. 使用隐身模式/无痕模式访问应用
4. 或使用强制更新工具

### Q3: 强制更新工具在哪里？

**A**: 直接访问：
```
https://sevenoy.github.io/meds/force-update.html
```

### Q4: 更新后数据会丢失吗？

**A**: 不会！您的所有数据都保存在：
- IndexedDB（本地数据库）
- Supabase（云端数据库）

清除缓存只会删除应用的代码文件，不会影响您的数据。

### Q5: 手机上的PWA应用如何更新？

**A**: 如果您已经将应用"添加到主屏幕"：

**iOS**:
1. 删除主屏幕上的应用图标
2. 清除Safari缓存
3. 重新访问网站
4. 重新"添加到主屏幕"

**Android**:
1. 长按应用图标
2. 卸载应用
3. 清除Chrome缓存
4. 重新访问网站
5. 重新安装PWA

---

## 📋 更新检查清单

- [ ] 尝试硬刷新（Ctrl+Shift+R / Cmd+Shift+R）
- [ ] 打开开发者工具，查看控制台版本号
- [ ] 使用强制更新工具
- [ ] 清除浏览器缓存
- [ ] 完全关闭并重启浏览器
- [ ] 使用隐身模式测试
- [ ] 手机PWA需要卸载重装

---

## 🆘 仍然无法更新？

如果尝试了所有方法还是无法更新，请：

1. **联系开发者**
   - 提供浏览器版本
   - 提供控制台截图
   - 说明尝试过的方法

2. **临时解决方案**
   - 使用其他浏览器访问
   - 使用隐身模式访问

---

## 📊 版本历史

### V251219.8 (最新)
- 优化多设备实时同步机制
- 药品列表自动同步（无需确认）
- 头像自动同步优化
- 同步间隔缩短到3秒
- 添加详细的同步日志

### V251219.7
- 创建强制更新工具
- 添加详细的更新指南
- 解决浏览器缓存导致无法更新的问题

### V251219.6
- 修复头像多设备同步功能
- 优化用户体验
- 添加版本管理规则

### V251219.5
- 用户头像功能
- 增强设置同步

---

**当前最新版本**: V251219.17  
**更新时间**: 2025年12月19日
